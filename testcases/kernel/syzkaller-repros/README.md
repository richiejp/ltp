# LTP wrapper for Syzkaller reproducers

This allows you to run the autogenerated bug reproducers from the Syzkaller
fuzzer within the LTP framework. Meaning that you may use an existing test
runner compatible with the LTP (with some constraints, see below).

However some extra setup is currently required.

## Instructions

1. Download and compile the reproducers.
2. Build the LTP as normal
3. Use the gen-runtest.pl script to create the runtest file(s)
4. Install the LTP and the reproducers to the SUT
5. Execute the tests in the syzkaller runtest file(s)

For now you can download the reproducers from here:
https://github.com/dvyukov/syzkaller-repros. Soon they will be available on
kernel.org.

The gen-runtest script takes a number of arguments see `./gen-runtest.pl
--help`.

For example:
```
./gen-runtest.pl --build-dir=~/syzkaller-repros/bin \
	             --sut-dir=/mnt/syzkaller/bin \
                 --out-dir=~/ltp-build/runtest \
				 --batch-size=100
```

For the LTP, just doing `make install` will copy all the relevant files
(assuming you put the runtest file(s) in the runtest folder). However you will
need to copy the reproducers yourself.

You can build the reproducers with the shell script or the following:
https://github.com/richiejp/syzkaller-repros/blob/makefile/Makefile

## Test Runner Requirements

When a bug is triggered, the machine is likely to become unresponsive. You can
not rely on the SUT uploading results at the end of a batch and you will most
likely have to reset the SUT multiple times during a batch.

It is best if the test runner returns the SUT to a known good state when the
kernel is tainted, IO with the SUT times out or even whenever a test fails.

Even if they do not trigger a bug, the reproducers can make a mess of your
environment. They create a lot of noise on the kernel log and create files
which are not easily deleted. While the LTP attempts to deal with this, it may
be best to run the tests in multiple small batches and reset the SUT
inbetween.

